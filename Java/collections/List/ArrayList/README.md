# ArrayList
![img.png](../../img.png)

По существу _ArrayList_ представляет собой списочный массив объектных ссылок переменной длины.

_ArrayList_ расширяет класс _AbstractList_ и реализует интерфейс _List_.

## Методы

Рассмотрим первоначально методы унаследованные от интерфейса _Collection_:

| Метод                                                 | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|:------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| boolean add(E e)                                      | Используется для вставки элемента в коллекцию                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| boolean addAll(Collection<? extends E> c)             | Используется для вставки переданной коллекции в исходную коллекцию                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| boolean remove(Object element)                        | Используется для удаления элемента из коллекции                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| boolean removeAll(Collection<?> c)                    | Используется для удаления всех элементов входящих в переданную коллекцию из исходной коллекции                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| default boolean removeIf(Predicate<? super E> filter) | Удаляет из коллекции элементы, удовлетворяющие условию, которое задает предикат                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| boolean retainAll(Collection<?> c)                    | Удаляет из вызывающей коллекции все элементы кроме элементов переданной коллекции                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| int size()                                            | Возвращает количество элементов в коллекции                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| void clear()                                          | Удаляет все элементы                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| boolean contains(Object element)                      | Если передаваемый элемент есть в коллекции - true, иначе - false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| boolean containsAll(Collection<?> c)                  | Если все элементы из передаваемой коллекции есть в исходной коллекции - true, иначе false                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| boolean isEmpty()                                     | Если вызывающая коллекция пуста - true, иначе - false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| int hashCode()                                        | Возвращает хэш-код коллекции                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| boolean equals(Object o)                              | Проверяет равнозначны ли коллекция и переданный объект                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| Iterator<E> iterator()                                | Возвращает итератор для исходной коллекции                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| default Spliterator<E> spliterator()                  | Возвращает итератор-разделитель для исходной коллекции                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| Object[] toArray()                                    | Возвращает массив, содержащий все элементы вызывающей коллекции. Элементы массива являются копиями элементов коллекции                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| default Stream<E> stream()                            | Возвращает поток данных, использующий коллекцию в качестве источника элементов                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| default Stream<E> parallelStream()                    | Возвращает поток данных, использующий коллекцию в качестве источника элементов. В этом потоке поддерживаются параллельные операции                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <T> T[] toArray(T array[])                            | Возвращает массив, содержащий элементы вызывающей коллекции. Элементы массива являются копиями элементов коллекции. Если размер переданного массива равен числу элементов в коллекции они возвращаются в заданном массиве. Если размер массива меньше чем элементов в коллекции, то создается новый массив нужного размера. Если размер переданного массива больше чем элементов, то во всех элементах, следующих за последним из коллекции, устанавливается null. Если тип коллекции и тип массива не совпадают, то генерируется исключение **ArrayStoreException** |
*Важно, что методы добавления и удаления возвращающие boolean, возвращают true если коллекция была изменена, false - если нет.

Далее рассмотрим методы интерфейса _List<E>_ :

| Метод                                            | Описание                                                                                                                                         |
|:-------------------------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------|
| void add(int i, E object)                        | Вводит заданный объект по указанному индексу, любые введенные элементы смещаются и не перезаписываются                                           |
| boolean addAll(int i, Collection<? extends E> c) | Вводит все элементы из переданной коллекции в исходную коллекцию по указанному индексу. Возвращает true если коллекция изменилась, иначе - false |
| E get(int i)                                     | Возвращает объект, хранящийся в списке по указанному индексу                                                                                     |
| int indexOf(Object o)                            | Возвращает индекс первого экземпляра переданного элемента в списке. Если объект не найден возвращается -1                                        |
| int lastIndexOf(Object o)                        | Возвращает индекс последнего экземпляра переданного элемента в списке. Если объект не найден возвращается -1                                     |
| ListIterator<E> listIterator()                   | Возвращает итератор для обхода элементов с начала вызывающего списка                                                                             |
| ListIterator<E> listIterator(int i)              | Возвращает итератор для обхода элементов с позиции по переданному индексу                                                                        |
| E remove(int i)                                  | Удаляет элемент по заданному индексу и возвращает удаленный элемент. Список также уплотняется, элементы за удаленным смещаются                   |
| default void replaceAll(UnaryOperator<E> op)     | Обновляет каждый элемент списка значением получаемым из переданной функции                                                                       |
| E set(int i, Object o)                           | Присваивает заданный объект элементу, находящемуся в списке на позиции по заданному индексу. Возвращает прежнее значение                         |
| default void sort(Comparator<? super E> c)       | Сортирует список, используя заданный компаратор                                                                                                  |
| List<E> subList(int start, int end)              | Возвращает список, включающий элементы от позиции start до end из вызывающего списка. Ссылки на элементы в списке остаются такими же             |

Также для ArrayList определены следующие методы:

| Метод                             | Описание                                                                          |
|:----------------------------------|:----------------------------------------------------------------------------------|
| void ensureCapacity(int capacity) | Метод позволяет увеличить внутренний массив до значения, переданного в метод      |
| void trimToSize()                 | Метод уменьшает размер внутреннего массива до текущего количества элементов в нем |

Далее рассмотрим варианты конструкторов ArrayList:

- _ArrayList()_ - пустой список, с емкостью внутреннего массива 10
- _ArrayList(Collection<? extends E> c)_ - список, инициализируемый элементами из переданной коллекции
- _ArrayList(int capacity)_ - список, имеющий начальную емкость массива равную переданному значению


Как уже упоминалось, в ArrayList содержится массив. При добавлении элемента проверяется достаточно ли места в массиве, если нет то создается новый массив с емкостью рассчитанной по формуле: _(oldCapacity * 3) / 2 + 1_. Далее происходит копирование всех элементов из прошлого массива в новый,
для этого используется нативный метод System.arraycopy(), который работает эффективно.

Также важным моментом является то, что при удалении элементов размер массива не изменяется, здесь может быть оправданным использование _trimToSize()_ в целях экономии памяти.
## Сложность

- Вставка/Удаление по индексу: _O(n)_
- Вставка в конец списка: _O(1)_
- get(): _O(1)_
- indexOf(): _O(n)_
- contains(): _O(n)_

## Exceptions

При создании списка: _IllegalArgumentException_ если capacity отрицательное, или _NPE_ если коллекция null.

При генерации массива из списка: _ArrayStoreException_ если тип переданного массива и коллекции не совпадают(или не являются супертипом), _NPE_ если переданный массив null

При любой операции по индексу _IndexOutOfBoundsException_ если индекс меньше нуля или больше размера

При removeAll и retainAll _ClassCastException_ если тип коллекции переданной в аргументе несовместим с основной коллекцией, _NPE_ если переденная коллекция null 

При вызове subList(int fromIndex, int toIndex) _IllegalArgumentException_ если fromIndex > toIndex, также _IndexOutOfBoundsException_ если какой либо индекс выходит за рамки массива 
